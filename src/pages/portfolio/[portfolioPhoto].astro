---
import PhotoPage from "../../components/PhotoPage.astro";
import { portfolioPhotoSlug } from "../../lib/utils";
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const photos = await getCollection('portfolio');
  photos.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

  const pages = photos.map((photo, i) => ({
    params: { portfolioPhoto: portfolioPhotoSlug(photo) },
    props: {
      photo: photo,
      prev: photos[i - 1],
      next: photos[i + 1],
    },
  }));
  return pages;
}

interface Props {
  photo: any;
  next: any;
  prev: any;
}

const { photo, prev, next } = Astro.props;
---

<PhotoPage
  photo={photo.data.photo}
  backLink={"/portfolio/1"}
  backLinkText="Portfolio"
  nextLink={next ? `/portfolio/${portfolioPhotoSlug(next)}` : null}
  prevLink={prev ? `/portfolio/${portfolioPhotoSlug(prev)}` : null}
/>
